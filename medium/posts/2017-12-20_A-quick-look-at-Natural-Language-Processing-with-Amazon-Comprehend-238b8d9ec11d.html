<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>A quick look at Natural Language Processing with Amazon Comprehend</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">A quick look at Natural Language Processing with Amazon Comprehend</h1>
</header>
<section data-field="subtitle" class="p-summary">
Amazon Comprehend is a new service announced at AWS re:Invent 2017. At the time of writing, it is available in the US (Virginia, Ohio…
</section>
<section data-field="body" class="e-content">
<section name="cf37" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ddf0" id="ddf0" class="graf graf--h3 graf--leading graf--title">A quick look at Natural Language Processing with Amazon Comprehend</h3><p name="6c90" id="6c90" class="graf graf--p graf-after--h3"><a href="http://aws.amazon.com/comprehend" data-href="http://aws.amazon.com/comprehend" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Amazon Comprehend</a> is a new service announced at AWS re:Invent 2017. At the time of writing, it is available in the US (Virginia, Ohio, Oregon) and in Europe (Ireland).</p><h4 name="3b12" id="3b12" class="graf graf--h4 graf-after--p">Features</h4><p name="1552" id="1552" class="graf graf--p graf-after--h4">This is what Amazon Comprehend is capable of right now:</p><ul class="postList"><li name="e8ae" id="e8ae" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Language</strong> detection (single document or batch mode),</li><li name="0d14" id="0d14" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Entity</strong> detection (single document or batch mode),</li><li name="2881" id="2881" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Key phrases</strong> extraction (single document or batch mode),</li><li name="da8a" id="da8a" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Sentiment</strong> analysis (single document or batch mode),</li><li name="fa6d" id="fa6d" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Topic</strong> <strong class="markup--strong markup--li-strong">modeling</strong> on large document collection.</li></ul><h4 name="0001" id="0001" class="graf graf--h4 graf-after--li">Detection, extraction and analysis</h4><p name="7d34" id="7d34" class="graf graf--p graf-after--h4">Let’s look at the first four features with a simple example in the console. Here’s a sample text from an Associated Press data set:</p><p name="f36d" id="f36d" class="graf graf--p graf--startsWithDoubleQuote graf-after--p"><em class="markup--em markup--p-em">“A suspect bit the ear of a 4-year-old police dog and injured the animal’s neck during a chase and arrest, police said today. The dog, Rex, was on patrol with Constable Philip Rajah in the Natal provincial capital during the weekend when they came across two suspicious individuals,’’ police said. While Rajah searched one man, Rex chased the other and got the worst of it when his quarry turned on the animal and bit him. Rajah had to yank the man off the dog, police said. They said the dog was being treated for a serious neck injury at a veterinary clinic. The man who bit the dog may face a charge of malicious injury to state property”.</em></p><p name="e3bd" id="e3bd" class="graf graf--p graf-after--p">What does Comprehend make of this crazy story?</p><figure name="6ccf" id="6ccf" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*F3YQmDHIJ_LExT7b-OryQg.png" data-width="2074" data-height="966" src="https://cdn-images-1.medium.com/max/800/1*F3YQmDHIJ_LExT7b-OryQg.png"></figure><p name="1f83" id="1f83" class="graf graf--p graf-after--figure">As you can see, <strong class="markup--strong markup--p-strong">key entities</strong> are properly identified: the police officer, Rex, the two individuals, the date and the location. Language is also detected as ‘English’.</p><p name="2e10" id="2e10" class="graf graf--p graf-after--p">What about key phrases?</p><figure name="1160" id="1160" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*vA0_WO09f7nstudWuV9j3w.png" data-width="1012" data-height="926" src="https://cdn-images-1.medium.com/max/800/1*vA0_WO09f7nstudWuV9j3w.png"></figure><p name="89de" id="89de" class="graf graf--p graf-after--figure">Once again, <strong class="markup--strong markup--p-strong">key phrases </strong>are understood. It’s quite likely that indexing them in a backend would let us find this article quickly and accurately.</p><p name="124c" id="124c" class="graf graf--p graf-after--p">Now, what about <strong class="markup--strong markup--p-strong">sentiment</strong>?</p><figure name="7904" id="7904" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*LJi00qljFH1Io6ERf0POQw.png" data-width="1012" data-height="518" src="https://cdn-images-1.medium.com/max/800/1*LJi00qljFH1Io6ERf0POQw.png"></figure><p name="65b0" id="65b0" class="graf graf--p graf-after--figure">Tone is indeed pretty neutral, although I’m quite sure poor Rex would think this is a pretty negative story :D</p><h4 name="d28c" id="d28c" class="graf graf--h4 graf-after--p">Language detection</h4><p name="a79b" id="a79b" class="graf graf--p graf-after--h4">Let’s take another shot at language detection. Comprehend is able to detect 100 languages, so let’s use tweets in three different languages: <a href="https://twitter.com/bbcswahili/status/94351680560744448" data-href="https://twitter.com/bbcswahili/status/94351680560744448" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">Swahili</strong></a>, <a href="https://twitter.com/filipinofood/status/939472973420937218" data-href="https://twitter.com/filipinofood/status/939472973420937218" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">Tagalog</strong></a> and <a href="https://twitter.com/tyzhdenUA/status/943498398199615488" data-href="https://twitter.com/tyzhdenUA/status/943498398199615488" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">Ukrainian</strong></a>. As you can see, these are rather short sentences, which are more difficult to detect than longer texts.</p><pre name="6d22" id="6d22" class="graf graf--pre graf-after--p">aws comprehend detect-dominant-language --text &quot;Wabunge wapitisha muswada wa ukomo wa rais Uganda kusomwa kwa mara ya pili&quot;<br>{<br>    &quot;Languages&quot;: [<br>        {<br>            &quot;LanguageCode&quot;: &quot;sw&quot;,<br>            &quot;Score&quot;: 0.994857907295227<br>        }<br>    ]<br>}</pre><pre name="818f" id="818f" class="graf graf--pre graf-after--pre">aws comprehend detect-dominant-language --text &quot;Nakabibili pala ng durian sa U.S. supermarkets kasama ng mga epol. Galing siguro sa Thailand.&quot;<br>{<br>    &quot;Languages&quot;: [<br>        {<br>            &quot;LanguageCode&quot;: &quot;tl&quot;,<br>            &quot;Score&quot;: 0.9984232187271118<br>        }<br>    ]<br>}</pre><pre name="347c" id="347c" class="graf graf--pre graf-after--pre">aws comprehend detect-dominant-language --text &quot;Помер відомий тренер та функціонер київського Динамо&quot;<br>{<br>    &quot;Languages&quot;: [<br>        {<br>            &quot;LanguageCode&quot;: &quot;uk&quot;,<br>            &quot;Score&quot;: 0.9999969005584717<br>        }<br>    ]<br>}</pre><p name="443c" id="443c" class="graf graf--p graf-after--pre">All three are correctly detected. Good job, Comprehend!</p><h4 name="a9d8" id="a9d8" class="graf graf--h4 graf-after--p">Topic modeling</h4><p name="b26d" id="b26d" class="graf graf--p graf-after--h4">Now, let’s take a look at <strong class="markup--strong markup--p-strong">topic modeling</strong>, a powerful technique allowing us to automatically:</p><ul class="postList"><li name="56b5" id="56b5" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">build a list of topics</strong> from a large document collection,</li><li name="38ba" id="38ba" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">group documents</strong> according to these topics.</li></ul><p name="57b6" id="57b6" class="graf graf--p graf-after--li">First of all, we need a <strong class="markup--strong markup--p-strong">data set</strong>. We’ll use a collection of 2,246 news items from Associated Press (<a href="http://www.cs.columbia.edu/~blei/lda-c/" data-href="http://www.cs.columbia.edu/~blei/lda-c/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">source</a>), stored in a TSV file.</p><p name="e31e" id="e31e" class="graf graf--p graf-after--p">First, we have to remove the first two columns (we don’t need them) and save the file in UTF-8 format, which is what Comprehend expects.</p><blockquote name="f8ce" id="f8ce" class="graf graf--blockquote graf-after--p">Amazon Comprehend expects documents to be stored in an S3 bucket: either one file per document, or a single file with one document per line. We’ll use the second option, as this is how our data set is structured.</blockquote><p name="352a" id="352a" class="graf graf--p graf-after--blockquote">Creating the job is straightforward: S3 bucket, file format, number of topics to detect, etc. Once the job is complete, we can download the results from S3.</p><figure name="7020" id="7020" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Z6eqTKz71x-Mtz69_L_G4g.png" data-width="888" data-height="1024" src="https://cdn-images-1.medium.com/max/800/1*Z6eqTKz71x-Mtz69_L_G4g.png"></figure><p name="c880" id="c880" class="graf graf--p graf-after--figure">The output file contains two CSV files: <strong class="markup--strong markup--p-strong">doc-topics.csv</strong> and <strong class="markup--strong markup--p-strong">topic-terms.csv</strong>.</p><h4 name="9d8e" id="9d8e" class="graf graf--h4 graf-after--p">Documents and topics</h4><p name="c093" id="c093" class="graf graf--p graf-after--h4">The <strong class="markup--strong markup--p-strong">doc-topics.csv</strong> file stores the list of <strong class="markup--strong markup--p-strong">topics</strong> and <strong class="markup--strong markup--p-strong">weights </strong>detected in each document (here each line in the file),</p><p name="5837" id="5837" class="graf graf--p graf-after--p">For example, let’s look at topics for document #648:</p><figure name="8c31" id="8c31" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*nAQDqFODPsv7ERG6fCZbYg.png" data-width="618" data-height="284" src="https://cdn-images-1.medium.com/max/800/1*nAQDqFODPsv7ERG6fCZbYg.png"></figure><p name="8983" id="8983" class="graf graf--p graf-after--figure">Here are the first few lines of this document: “<em class="markup--em markup--p-em">Savings institution depositors withdrew more money from their accounts than they deposited in May for the first time in seven months, while losses continued to erode the ailing industry’s capital, the government said Monday. The Federal Home Loan Bank Board said net withdrawals at the nation’s 3,102 federally insured S &amp;Ls totaled $941 million in May. But the decline came after seven consecutive months of net deposit gains totaling $28 billion</em>”.</p><p name="5c9b" id="5c9b" class="graf graf--p graf-after--p">Looks like ‘finance’ is the key topic here.</p><h4 name="63d9" id="63d9" class="graf graf--h4 graf-after--p">Topics and terms</h4><p name="c336" id="c336" class="graf graf--p graf-after--h4">The <strong class="markup--strong markup--p-strong">topic-terms.csv</strong> file stores the list of topics that have been detected in the document collection. For each topic, we see a list of words and their weights.</p><p name="21fe" id="21fe" class="graf graf--p graf-after--p">The dominant topic in document #648 is topic #3: let’s check what it’s about.</p><figure name="9234" id="9234" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*XZ7bT3Yfpphz7p3K2cwj7w.png" data-width="566" data-height="470" src="https://cdn-images-1.medium.com/max/800/1*XZ7bT3Yfpphz7p3K2cwj7w.png"></figure><p name="59d6" id="59d6" class="graf graf--p graf-after--figure">These words could reasonably be associated with a ‘finance’ topic, so it’s a pretty good match for the document above.</p><p name="1151" id="1151" class="graf graf--p graf-after--p">Curious about this works? Read on :)</p><h3 name="79b8" id="79b8" class="graf graf--h3 graf-after--p">Latent Dirichlet Allocation (LDA)</h3><p name="9908" id="9908" class="graf graf--p graf-after--h3"><a href="https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation" data-href="https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">LDA</a> is an <strong class="markup--strong markup--p-strong">unsupervised learning algorithm</strong> which is commonly used to discover a user-specified number of <strong class="markup--strong markup--p-strong">topics</strong> shared by <strong class="markup--strong markup--p-strong">documents</strong> within a text <strong class="markup--strong markup--p-strong">collection</strong>.</p><blockquote name="6bf4" id="6bf4" class="graf graf--blockquote graf-after--p">As a sidenote, LDA is one of the built-algorithms available in <a href="http://aws.amazon.com/sagemaker" data-href="http://aws.amazon.com/sagemaker" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">Amazon SageMaker</a> . You’ll find a high-level description <a href="http://docs.aws.amazon.com/sagemaker/latest/dg/lda-how-it-works.html" data-href="http://docs.aws.amazon.com/sagemaker/latest/dg/lda-how-it-works.html" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">here</a>.</blockquote><p name="18de" id="18de" class="graf graf--p graf-after--blockquote">If you want to dive deeper (and I mean ‘deeper’) on topic modeling and LDA, I strongly recommend this re:Invent video by my colleague Anima Anandkumar.</p><figure name="20b3" id="20b3" class="graf graf--figure graf--iframe graf-after--p"><iframe src="https://www.youtube.com/embed/mINfveR9VVE?feature=oembed" width="700" height="393" frameborder="0" scrolling="no"></iframe></figure><p name="7d98" id="7d98" class="graf graf--p graf-after--figure graf--trailing">That’s it for today. Thank you for reading.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@julsimon" class="p-author h-card">Julien Simon</a> on <a href="https://medium.com/p/238b8d9ec11d"><time class="dt-published" datetime="2017-12-20T20:47:04.722Z">December 20, 2017</time></a>.</p><p><a href="https://medium.com/@julsimon/a-quick-look-at-natural-language-processing-with-amazon-comprehend-238b8d9ec11d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on July 26, 2025.</p></footer></article></body></html>
