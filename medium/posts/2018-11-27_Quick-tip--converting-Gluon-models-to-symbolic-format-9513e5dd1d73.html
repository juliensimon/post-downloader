<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Quick tip: converting Gluon models to symbolic format</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Quick tip: converting Gluon models to symbolic format</h1>
</header>
<section data-field="subtitle" class="p-summary">
As discussed earlier, Gluon is an imperative API available on top of the symbolic API implemented by Apache MXNet.
</section>
<section data-field="body" class="e-content">
<section name="fba7" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="51db" id="51db" class="graf graf--h3 graf--leading graf--title">Quick tip: converting Gluon models to symbolic format</h3><p name="fed3" id="fed3" class="graf graf--p graf-after--h3">As discussed <a href="https://medium.com/@julsimon/gluon-building-blocks-for-your-deep-learning-universe-4bce4e56ef55" data-href="https://medium.com/@julsimon/gluon-building-blocks-for-your-deep-learning-universe-4bce4e56ef55" class="markup--anchor markup--p-anchor" target="_blank">earlier</a>, Gluon is an imperative API available on top of the symbolic API implemented by <a href="http://mxnet.incubator.apache.org" data-href="http://mxnet.incubator.apache.org" class="markup--anchor markup--p-anchor" rel="nofollow noopener noopener" target="_blank">Apache MXNet</a>.</p><p name="a854" id="a854" class="graf graf--p graf-after--p">One of the cool features of Gluon is the extensive <a href="https://gluon-cv.mxnet.io/api/model_zoo.html" data-href="https://gluon-cv.mxnet.io/api/model_zoo.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">collection</a> of pre-trained computer vision models available in <a href="https://github.com/dmlc/gluon-cv" data-href="https://github.com/dmlc/gluon-cv" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Gluon CV</a>. Using these models with the Gluon API is extremely easy, but sometimes we’d rather use the symbolic API instead.</p><p name="decb" id="decb" class="graf graf--p graf-after--p">One reason could be language support: Gluon is Python only whereas MXNet supports a whole list of languages including C++, which you may need to get the best prediction performance possible. Unfortunately, the MXNet model zoo is not synchronized with the Gluon model zoo, so you can’t just grab the same models.</p><p name="6d31" id="6d31" class="graf graf--p graf-after--p">One easy solution to this problem is to use the Gluon API to download models, export them to symbolic format and then load them using the MXNet API.</p><p name="3afd" id="3afd" class="graf graf--p graf-after--p">It goes like this.</p><pre name="6de7" id="6de7" class="graf graf--pre graf-after--p">from gluoncv import model_zoo<br>import mxnet as mx<br>import numpy as np</pre><pre name="db9b" id="db9b" class="graf graf--pre graf-after--pre"># Download the model from the Gluon model zoo<br># You&#39;ll find it in ~/.mxnet/models<br>net = model_zoo.get_model(&#39;resnet50_v1&#39;, pretrained=True)</pre><pre name="9e83" id="9e83" class="graf graf--pre graf-after--pre"># Convert the model to symbolic format<br>net.hybridize()</pre><pre name="f5ad" id="f5ad" class="graf graf--pre graf-after--pre"># Build a fake image to run a single prediction<br># This is required to initialize the model properly<br>x = np.zeros([1,3,224,244])<br>x = mx.nd.array(x)</pre><pre name="f98a" id="f98a" class="graf graf--pre graf-after--pre"># Predict the fake image<br>net.forward(x)</pre><pre name="337b" id="337b" class="graf graf--pre graf-after--pre"># Export the model<br>net.export(&#39;resnet50_v1&#39;)</pre><p name="a354" id="a354" class="graf graf--p graf-after--pre">This will export the model weights and the JSON file containing the symbolic definition of the model.</p><pre name="ebdf" id="ebdf" class="graf graf--pre graf-after--p">$ ls -1 resnet50*<br>resnet50_v1-0000.params<br>resnet50_v1-symbol.json</pre><p name="73f3" id="73f3" class="graf graf--p graf-after--pre">Now you can load this model as usual with the <a href="https://mxnet.incubator.apache.org/api/python/module/module.html" data-href="https://mxnet.incubator.apache.org/api/python/module/module.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">model.load_checkpoint()</em></a> API. Just make sure you use a recent version of MXNet, as Gluon models could be incompatible with older ones. YMMV.</p><pre name="cfab" id="cfab" class="graf graf--pre graf-after--p">import mxnet as mx</pre><pre name="6cc1" id="6cc1" class="graf graf--pre graf-after--pre">sym, arg, aux = mx.model.load_checkpoint(&quot;resnet50_v1&quot;, 0)<br>...</pre><p name="94d4" id="94d4" class="graf graf--p graf-after--pre graf--trailing">That’s it. Now you can enjoy all these models with the symbolic API :)</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@julsimon" class="p-author h-card">Julien Simon</a> on <a href="https://medium.com/p/9513e5dd1d73"><time class="dt-published" datetime="2018-11-27T00:08:41.652Z">November 27, 2018</time></a>.</p><p><a href="https://medium.com/@julsimon/quick-tip-converting-gluon-models-to-symbolic-format-9513e5dd1d73" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on July 26, 2025.</p></footer></article></body></html>
