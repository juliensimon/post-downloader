<!DOCTYPE html>
<html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><title>Training a Vision Transformer on Amazon SageMaker</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">


<section class="e-content" data-field="body">
<section class="section"><div><hr/></div><div><div><h3 id="450b">Training a Vision Transformer on Amazon SageMaker</h3><p id="71ad">In this series of three videos, I focus on training a <a href="https://huggingface.co/transformers/model_doc/vit.html" target="_blank">Vision Transformer</a> model on <a href="https://aws.amazon.com/sagemaker/" target="_blank">Amazon SageMaker</a>.</p><p id="b76e">In the first video, I start from the « Dogs vs Cats » dataset on Kaggle, and I extract a subset of images that I upload to S3. Then, using SageMaker Processing, I run a script that loads the images directly from S3 into memory, extracts their features using the Vision Transformer feature extractor, and stores them in S3 as Hugging Face datasets for image classification.</p><figure id="3806"><iframe frameborder="0" height="393" scrolling="no" src="https://www.youtube.com/embed/jalopOoBL5M?feature=oembed" width="700"></iframe></figure><p id="5eda">In the second video, I start from the image classification dataset that I prepared in the first video. Then, I download a pre-trained Vision Transformer from the Hugging Face hub, and I fine-tune it on my dataset, using a training script based on the Trainer API in the Transformers library.</p><figure id="b983"><iframe frameborder="0" height="393" scrolling="no" src="https://www.youtube.com/embed/iiw9dNG7JcU?feature=oembed" width="700"></iframe></figure><p id="4d9f">In the third video, I start from the image classification dataset that I prepared in the first video. Then, I download a pre-trained base Vision Transformer from the Hugging Face hub, and I use PyTorch Lightning to append a classification layer to it. Finally, I train the model using the Trainer API in PyTorch Lightning.</p><p id="bf90">Resources:</p><ul class="postList"><li id="c90b">Vision Transformer paper: <a href="https://arxiv.org/abs/2010.11929" target="_blank">https://arxiv.org/abs/2010.11929</a></li><li id="8eb1">Dataset: <a href="https://www.kaggle.com/c/dogs-vs-cats/" target="_blank">https://www.kaggle.com/c/dogs-vs-cats/</a></li><li id="c667">Code: <a href="https://gitlab.com/juliensimon/huggingface-demos/-/tree/main/vision-transformer" target="_blank">https://gitlab.com/juliensimon/huggingface-demos/-/tree/main/vision-transformer</a></li><li id="8b85">More Hugging Face on SageMaker notebooks: <a href="https://github.com/huggingface/notebooks/tree/master/sagemaker" target="_blank">https://github.com/huggingface/notebooks/tree/master/sagemaker</a></li></ul></div></div></section><section class="section"><div><hr/></div><div><div><p id="7208">New to Transformers? Check out the <a href="https://huggingface.co/course" target="_blank">Hugging Face course</a>!</p></div></div></section>
</section>
</article></body></html>